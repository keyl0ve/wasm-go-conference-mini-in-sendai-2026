# マリオ風プラットフォーマーゲーム 🍄

Ebitengineを使ったスーパーマリオブラザーズ風の横スクロールアクションゲームです。

## ゲームの内容

### 実装済み機能

- プレイヤーキャラクター（赤い四角形）と歩行・ジャンプアニメーション
- 重力システム・ジャンプアクション
- 複数の足場・衝突判定（上下左右）
- 敵キャラクター（踏むと撃破、横から当たるとリセット）
- コイン収集（スコア+10）
- 横スクロールカメラ（ステージ幅2400）
- 効果音（ジャンプ・コイン・敵撃破・ゴール）
- **ゴール（旗）**: ステージ右端の旗に触れるとクリア。クリア後は旗が降り、スペースキーでリスタート。残りコイン×50のボーナスあり。

### 今後追加予定

- [ ] アイテム（キノコなど）
- [ ] スプライト画像
- [ ] BGM
- [ ] ステージ2以降

## 実行方法

### デスクトップ

```bash
cd mario-game
go run .
```

### ブラウザ（WASM）

```bash
cd mario-game
./build-wasm.sh          # macOS/Linux（Windows は build-wasm.bat）
go run ./cmd/server     # サーバー起動
```

ブラウザで **http://localhost:8080** を開く。

## 操作方法

- **←→キー** または **A/D キー**: 左右に移動
- **スペースキー** または **↑キー** または **W キー**: ジャンプ
- **ゴール到達後**: スペースキーでリスタート

## ゲームの仕組み

### 物理演算

- **重力**: 毎フレーム下向きの速度が増加（gravity = 0.5）
- **ジャンプ**: 地面にいる時だけジャンプ可能（jumpPower = -12）
- **移動**: 一定速度で左右に移動（moveSpeed = 4）

### 衝突判定

- **着地**: 上から足場に乗る
- **天井**: 下から足場にぶつかる
- **壁**: 左右から足場にぶつかる
- **画面外**: 下に落ちたらスタート地点に戻る
- **ゴール**: ステージ右端の旗に触れるとクリア（残りコイン×50がボーナス加算）

### デバッグ情報

画面左上に表示される情報：

- プレイヤーの位置 (x, y)
- プレイヤーの速度 (vx, vy)
- 地面に接しているか (isGrounded)
- スコア

## 技術スタック

- Go 1.25.0
- Ebitengine v2.9.8

## コードの構造

```
main.go
├── Player / Platform / Enemy / Coin / Goal 構造体
├── Game 構造体        # ゲーム全体の管理（gameState: playing/cleared）
├── Update()           # ゲームロジック更新
│   ├── cleared時: 旗アニメ・スペースでリスタート
│   ├── 入力・物理・衝突・コイン・敵・ゴール判定
│   └── カメラ追従
└── Draw()             # 描画（足場・コイン・ゴール・敵・プレイヤー・クリア画面）
```

## 参考

- [Ebitengine公式サイト](https://ebitengine.org/ja/)
